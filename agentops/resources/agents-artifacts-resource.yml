# Allow users to read the experiment 
common_permissions: &permissions
  permissions:
    - level: CAN_READ
      group_name: users

# Allow users to execute models in Unity Catalog
grants: &grants
  grants:
    - privileges:
        - EXECUTE
      principal: account users

# Defines model and experiments
resources:
  registered_models:
      model:
        name: ${var.registered_model}
        catalog_name: ${var.uc_catalog}
        schema_name: ${var.schema}
        comment: Registered model in Unity Catalog for the "${bundle.name}" ML Project for ${bundle.target} deployment target.
        <<: *grants

  experiments:
    experiment:
      name: ${var.experiment}
      <<: *permissions

# NOTE: Model serving endpoint and feedback model are NOT pre-created here
# Following Databricks guidance: let agents.deploy() create and manage these resources
# Both the endpoint and feedback model will be auto-created by agents.deploy() in the ModelServing notebook
# See: https://docs.databricks.com/en/generative-ai/deploy-agent.html
#
# NOTE: Databricks App is defined in app-resource.yml, not here